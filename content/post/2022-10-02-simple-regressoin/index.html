---
title: Simple Regression with R
author: Jes LaCourse
date: '2022-10-02'
slug: [SimpleRegression]
categories: ['Regression']
tags: ['Regression', 'plotly']
description: ''
---

<script src="{{< blogdown/postref >}}index_files/kePrint/kePrint.js"></script>
<link href="{{< blogdown/postref >}}index_files/lightable/lightable.css" rel="stylesheet" />
<script src="{{< blogdown/postref >}}index_files/htmlwidgets/htmlwidgets.js"></script>
<script src="{{< blogdown/postref >}}index_files/plotly-binding/plotly.js"></script>
<script src="{{< blogdown/postref >}}index_files/typedarray/typedarray.min.js"></script>
<script src="{{< blogdown/postref >}}index_files/jquery/jquery.min.js"></script>
<link href="{{< blogdown/postref >}}index_files/crosstalk/css/crosstalk.min.css" rel="stylesheet" />
<script src="{{< blogdown/postref >}}index_files/crosstalk/js/crosstalk.min.js"></script>
<link href="{{< blogdown/postref >}}index_files/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="{{< blogdown/postref >}}index_files/plotly-main/plotly-latest.min.js"></script>


<div id="fitting-a-line-to-data" class="section level1">
<h1>Fitting a Line to Data</h1>
<p>Simple linear regression a method of estimating an outcome based on a related variable. In this case, we’ll walkthrough estimating systolic blood pressure (our outcome) based on age (a variable) using R.</p>
<p>Linear regression is presented in point-slope form, with parameters <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> making up our slope and intercept, respectively.</p>
<p><span class="math display">\[y = \beta_0 + \beta_1x\]</span></p>
<p>We’ll want to estimate the systolic blood pressure, <span class="math inline">\(y\)</span>, for 20 subjects based on their age, <span class="math inline">\(x\)</span>. <span class="math inline">\(\beta\)</span>’s are usually unknown, but in this case we know we want to be reasonably close to <span class="math inline">\(\beta_0=90\)</span> and <span class="math inline">\(\beta_1=0.9\)</span>. In other words, after many repeated experiments we’ve determined that the true intercept of our regression line is <span class="math inline">\(90\)</span> mmHg and our true slope is about <span class="math inline">\(0.9\)</span> mmHg/yr.</p>
<p><span class="math display">\[y = 90 + 0.9x\]</span></p>
<p>Here are our 20 subjects:</p>
<table style="color:white; font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;" class=" lightable-paper">
<caption>
<span id="tab:createSample">Table 1: </span>Blood Pressure Sample
</caption>
<tbody>
<tr>
<td style="text-align:left;">
subject
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
7
</td>
<td style="text-align:left;">
8
</td>
<td style="text-align:left;">
9
</td>
<td style="text-align:left;">
10
</td>
<td style="text-align:left;">
11
</td>
<td style="text-align:left;">
12
</td>
<td style="text-align:left;">
13
</td>
<td style="text-align:left;">
14
</td>
<td style="text-align:left;">
15
</td>
<td style="text-align:left;">
16
</td>
<td style="text-align:left;">
17
</td>
<td style="text-align:left;">
18
</td>
<td style="text-align:left;">
19
</td>
<td style="text-align:left;">
20
</td>
</tr>
<tr>
<td style="text-align:left;">
age
</td>
<td style="text-align:left;">
58
</td>
<td style="text-align:left;">
46
</td>
<td style="text-align:left;">
56
</td>
<td style="text-align:left;">
37
</td>
<td style="text-align:left;">
23
</td>
<td style="text-align:left;">
30
</td>
<td style="text-align:left;">
20
</td>
<td style="text-align:left;">
25
</td>
<td style="text-align:left;">
31
</td>
<td style="text-align:left;">
50
</td>
<td style="text-align:left;">
34
</td>
<td style="text-align:left;">
27
</td>
<td style="text-align:left;">
22
</td>
<td style="text-align:left;">
52
</td>
<td style="text-align:left;">
20
</td>
<td style="text-align:left;">
42
</td>
<td style="text-align:left;">
20
</td>
<td style="text-align:left;">
58
</td>
<td style="text-align:left;">
24
</td>
<td style="text-align:left;">
35
</td>
</tr>
<tr>
<td style="text-align:left;">
bp
</td>
<td style="text-align:left;">
167
</td>
<td style="text-align:left;">
136
</td>
<td style="text-align:left;">
116
</td>
<td style="text-align:left;">
116
</td>
<td style="text-align:left;">
101
</td>
<td style="text-align:left;">
121
</td>
<td style="text-align:left;">
103
</td>
<td style="text-align:left;">
101
</td>
<td style="text-align:left;">
105
</td>
<td style="text-align:left;">
158
</td>
<td style="text-align:left;">
117
</td>
<td style="text-align:left;">
118
</td>
<td style="text-align:left;">
113
</td>
<td style="text-align:left;">
148
</td>
<td style="text-align:left;">
105
</td>
<td style="text-align:left;">
142
</td>
<td style="text-align:left;">
89
</td>
<td style="text-align:left;">
153
</td>
<td style="text-align:left;">
122
</td>
<td style="text-align:left;">
135
</td>
</tr>
</tbody>
</table>
<div id="first-the-basics" class="section level2">
<h2>First the Basics</h2>
<p>It’s good to get a feel for the characteristics of our sample. Our subject information is stored in a dataframe called <code>data</code>.</p>
<p>We’ll want to collect some fundamental information about our sample.</p>
<p>Call <code>summary(data)</code>:</p>
<pre><code>##    subject               age              bp       
##  Length:20          Min.   :20.00   Min.   : 89.0  
##  Class :character   1st Qu.:23.75   1st Qu.:105.0  
##  Mode  :character   Median :32.50   Median :117.5  
##                     Mean   :35.50   Mean   :123.3  
##                     3rd Qu.:47.00   3rd Qu.:137.5  
##                     Max.   :58.00   Max.   :167.0</code></pre>
<p>The summary tells us we have 20 subjects with a mean age of <span class="math inline">\(35.5\)</span> years. Looking at the quartiles, then our minimum and maximum values, the ages appear to be evenly distributed from 20 to 58 years. A quick check of our blood pressure data shows values that are evenly distributed as well. We’ll look at formal diagnostics later, but right now linear regression is looking like a good tool for estimation.</p>
</div>
<div id="visualizing-data" class="section level2">
<h2>Visualizing Data</h2>
<p>The function <code>ggplotly()</code> from the <code>plotly</code> library is a fantastic way to convert <code>ggplot()</code> items into interactive figures. Note that you can simply use the <code>ggplot()</code> code in the brackets for a static plot.</p>
<pre class="r"><code>    {
      ggplot(data, aes(name = subject, x = age, y = bp )) + 
      geom_point() + 
      labs(title = &quot;Blood Pressure by Age, n = 20&quot;, 
           y = &quot;Blood Pressure (mmHg)&quot;, 
           x = &quot;Age (Years)&quot;)
    } %&gt;% 
    ggplotly()</code></pre>
<div id="htmlwidget-1" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"data":[{"x":[58,46,56,37,23,30,20,25,31,50,34,27,22,52,20,42,20,58,24,35],"y":[167,136,116,116,101,121,103,101,105,158,117,118,113,148,105,142,89,153,122,135],"text":["age: 58<br />bp: 167<br />subject: 1","age: 46<br />bp: 136<br />subject: 2","age: 56<br />bp: 116<br />subject: 3","age: 37<br />bp: 116<br />subject: 4","age: 23<br />bp: 101<br />subject: 5","age: 30<br />bp: 121<br />subject: 6","age: 20<br />bp: 103<br />subject: 7","age: 25<br />bp: 101<br />subject: 8","age: 31<br />bp: 105<br />subject: 9","age: 50<br />bp: 158<br />subject: 10","age: 34<br />bp: 117<br />subject: 11","age: 27<br />bp: 118<br />subject: 12","age: 22<br />bp: 113<br />subject: 13","age: 52<br />bp: 148<br />subject: 14","age: 20<br />bp: 105<br />subject: 15","age: 42<br />bp: 142<br />subject: 16","age: 20<br />bp:  89<br />subject: 17","age: 58<br />bp: 153<br />subject: 18","age: 24<br />bp: 122<br />subject: 19","age: 35<br />bp: 135<br />subject: 20"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.7625570776256,"r":7.30593607305936,"b":40.1826484018265,"l":43.1050228310502},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"title":{"text":"Blood Pressure by Age, n = 20","font":{"color":"rgba(0,0,0,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[18.1,59.9],"tickmode":"array","ticktext":["20","30","40","50"],"tickvals":[20,30,40,50],"categoryorder":"array","categoryarray":["20","30","40","50"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"Age (Years)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[85.1,170.9],"tickmode":"array","ticktext":["100","125","150"],"tickvals":[100,125,150],"categoryorder":"array","categoryarray":["100","125","150"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"Blood Pressure (mmHg)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"2ba828f313b5":{"x":{},"y":{},"name":{},"type":"scatter"}},"cur_data":"2ba828f313b5","visdat":{"2ba828f313b5":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>We certainly have a linear trend. There also appear to be slightly more younger subjects than older subjects. One of our subjects, <code>subject 3</code>, appears to have a blood pressure substantially lower than expected at (56,116).</p>
</div>
<div id="modeling" class="section level2">
<h2>Modeling</h2>
<pre class="r"><code>lm(data, formula = bp ~age) -&gt; m
m</code></pre>
<pre><code>## 
## Call:
## lm(formula = bp ~ age, data = data)
## 
## Coefficients:
## (Intercept)          age  
##      76.633        1.315</code></pre>
<pre class="r"><code>summary(m)</code></pre>
<pre><code>## 
## Call:
## lm(formula = bp ~ age, data = data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -34.248  -6.525   1.099   8.124  15.639 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  76.6333     7.9199   9.676 1.48e-08 ***
## age           1.3146     0.2091   6.288 6.28e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 12.36 on 18 degrees of freedom
## Multiple R-squared:  0.6872, Adjusted R-squared:  0.6698 
## F-statistic: 39.54 on 1 and 18 DF,  p-value: 6.284e-06</code></pre>
<pre class="r"><code>mean(m$residuals^2)</code></pre>
<pre><code>## [1] 137.5595</code></pre>
<pre class="r"><code>data %&gt;% 
  {
    ggplot(.,aes(age,bp)) +
    geom_point() + 
    geom_line(aes(y = m$coefficients[1] + m$coefficients[2]*x)) +
    geom_line( aes(y = 90+x*0.9), color = &quot;red&quot;) +
    theme_bw()
  } %&gt;% 
  ggplotly(., tooltip = list(&quot;x&quot;, &quot;y&quot;))</code></pre>
<div id="htmlwidget-2" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-2">{"x":{"data":[{"x":[58,46,56,37,23,30,20,25,31,50,34,27,22,52,20,42,20,58,24,35],"y":[167,136,116,116,101,121,103,101,105,158,117,118,113,148,105,142,89,153,122,135],"text":["age: 58<br />bp: 167","age: 46<br />bp: 136","age: 56<br />bp: 116","age: 37<br />bp: 116","age: 23<br />bp: 101","age: 30<br />bp: 121","age: 20<br />bp: 103","age: 25<br />bp: 101","age: 31<br />bp: 105","age: 50<br />bp: 158","age: 34<br />bp: 117","age: 27<br />bp: 118","age: 22<br />bp: 113","age: 52<br />bp: 148","age: 20<br />bp: 105","age: 42<br />bp: 142","age: 20<br />bp:  89","age: 58<br />bp: 153","age: 24<br />bp: 122","age: 35<br />bp: 135"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[20,20,20,22,23,24,25,27,30,31,34,35,37,42,46,50,52,56,58,58],"y":[102.924392336288,102.924392336288,102.924392336288,105.553503002574,106.868058335716,108.182613668859,109.497169002002,112.126279668287,116.069945667715,117.384501000858,121.328167000286,122.642722333429,125.271832999714,131.844609665428,137.102830997998,142.361052330569,144.990162996854,150.248384329425,152.877494995711,152.877494995711],"text":["age: 20<br />m$coefficients[1] + m$coefficients[2] * x: 102.9244","age: 20<br />m$coefficients[1] + m$coefficients[2] * x: 102.9244","age: 20<br />m$coefficients[1] + m$coefficients[2] * x: 102.9244","age: 22<br />m$coefficients[1] + m$coefficients[2] * x: 105.5535","age: 23<br />m$coefficients[1] + m$coefficients[2] * x: 106.8681","age: 24<br />m$coefficients[1] + m$coefficients[2] * x: 108.1826","age: 25<br />m$coefficients[1] + m$coefficients[2] * x: 109.4972","age: 27<br />m$coefficients[1] + m$coefficients[2] * x: 112.1263","age: 30<br />m$coefficients[1] + m$coefficients[2] * x: 116.0699","age: 31<br />m$coefficients[1] + m$coefficients[2] * x: 117.3845","age: 34<br />m$coefficients[1] + m$coefficients[2] * x: 121.3282","age: 35<br />m$coefficients[1] + m$coefficients[2] * x: 122.6427","age: 37<br />m$coefficients[1] + m$coefficients[2] * x: 125.2718","age: 42<br />m$coefficients[1] + m$coefficients[2] * x: 131.8446","age: 46<br />m$coefficients[1] + m$coefficients[2] * x: 137.1028","age: 50<br />m$coefficients[1] + m$coefficients[2] * x: 142.3611","age: 52<br />m$coefficients[1] + m$coefficients[2] * x: 144.9902","age: 56<br />m$coefficients[1] + m$coefficients[2] * x: 150.2484","age: 58<br />m$coefficients[1] + m$coefficients[2] * x: 152.8775","age: 58<br />m$coefficients[1] + m$coefficients[2] * x: 152.8775"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[20,20,20,22,23,24,25,27,30,31,34,35,37,42,46,50,52,56,58,58],"y":[108,108,108,109.8,110.7,111.6,112.5,114.3,117,117.9,120.6,121.5,123.3,127.8,131.4,135,136.8,140.4,142.2,142.2],"text":["age: 20<br />90 + x * 0.9: 108.0","age: 20<br />90 + x * 0.9: 108.0","age: 20<br />90 + x * 0.9: 108.0","age: 22<br />90 + x * 0.9: 109.8","age: 23<br />90 + x * 0.9: 110.7","age: 24<br />90 + x * 0.9: 111.6","age: 25<br />90 + x * 0.9: 112.5","age: 27<br />90 + x * 0.9: 114.3","age: 30<br />90 + x * 0.9: 117.0","age: 31<br />90 + x * 0.9: 117.9","age: 34<br />90 + x * 0.9: 120.6","age: 35<br />90 + x * 0.9: 121.5","age: 37<br />90 + x * 0.9: 123.3","age: 42<br />90 + x * 0.9: 127.8","age: 46<br />90 + x * 0.9: 131.4","age: 50<br />90 + x * 0.9: 135.0","age: 52<br />90 + x * 0.9: 136.8","age: 56<br />90 + x * 0.9: 140.4","age: 58<br />90 + x * 0.9: 142.2","age: 58<br />90 + x * 0.9: 142.2"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(255,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.2283105022831,"r":7.30593607305936,"b":40.1826484018265,"l":43.1050228310502},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[18.1,59.9],"tickmode":"array","ticktext":["20","30","40","50"],"tickvals":[20,30,40,50],"categoryorder":"array","categoryarray":["20","30","40","50"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"age","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[85.1,170.9],"tickmode":"array","ticktext":["100","125","150"],"tickvals":[100,125,150],"categoryorder":"array","categoryarray":["100","125","150"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"bp","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"2ba84f28751e":{"x":{},"y":{},"type":"scatter"},"2ba822e83aac":{"x":{},"y":{}},"2ba8e9862ca":{"x":{},"y":{}}},"cur_data":"2ba84f28751e","visdat":{"2ba84f28751e":["function (y) ","x"],"2ba822e83aac":["function (y) ","x"],"2ba8e9862ca":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
